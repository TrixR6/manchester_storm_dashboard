<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rundown View</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #FFFFFF;
            color: #000000;
        }
        .navbar {
            background-color: #001F3F;
        }
        .navbar-brand img {
            height: 40px;
        }
        .navbar-nav .nav-link {
            color: #FFD700 !important;
        }
        .navbar-nav .nav-link:hover {
            color: #FFFFFF !important;
        }
        .table {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="#"><img src="https://upload.wikimedia.org/wikipedia/en/c/c7/ManchesterStorm.png" alt="Logo"></a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="/">Dashboard</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="rundownDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Rundown
                    </a>
                    <div class="dropdown-menu" aria-labelledby="rundownDropdown">
                        <a class="dropdown-item" href="/rundown">View Rundown</a>
                        <a class="dropdown-item" href="/edit_rundown">Edit Rundown</a>
                        <a class="dropdown-item" href="/import_rundown">Import Rundown</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/roster">Rosters</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/admin">Admin Panel</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/events">Events Management</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="miscDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Misc
                    </a>
                    <div class="dropdown-menu" aria-labelledby="miscDropdown">
                        <a class="dropdown-item" href="https://www.manchesterstorm.com/" target="_blank">Manchester Storm Website</a>
                        <a class="dropdown-item" href="https://www.eliteleague.co.uk/" target="_blank">EIHL Website</a>
                        <a class="dropdown-item" href="https://hub.eihl.tv/users/sign_in" target="_blank">EIHL TV Hub</a>
                    </div>
                </li>
            </ul>
            <span class="navbar-text ml-auto clock">
                <span id="currentStage">{{ state.current_stage.replace('_', ' ') }}</span> -
                <span id="datetime"></span>
            </span>
        </div>
    </nav>
    <div class="container">
        <h3 class="mt-4">Show Rundown</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Segment Number</th>
                    <th>Item Name</th>
                    <th>Start Time</th>
                    <th>Duration</th>
                    <th>Notes</th>
                    <th>Video</th>
                    <th>Graphics</th>
                    <th>Audio</th>
                    <th>Script</th>
                    <th>Talent</th>
                    <th>Color</th>
                </tr>
            </thead>
            <tbody>
                {% for segment in rundown %}
                <tr style="background-color: {{ segment.color }};">
                    <td>{{ segment.number }}</td>
                    <td>{{ segment.item_name }}</td>
                    <td>{{ segment.start_time }}</td>
                    <td>{{ segment.duration }}</td>
                    <td>{{ segment.notes }}</td>
                    <td>{{ segment.video }}</td>
                    <td>{{ segment.graphics }}</td>
                    <td>{{ segment.audio }}</td>
                    <td>{{ segment.script }}</td>
                    <td>{{ segment.talent }}</td>
                    <td>{{ segment.color_name }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="mt-3">
        <a href="/export_rundown" class="btn btn-success">Export Rundown as JSON</a>
        <a href="/import_rundown" class="btn btn-primary">Import Rundown from JSON</a>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        function updateClock() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            document.getElementById('datetime').innerText = now.toLocaleDateString('en-US', options).replace(' at ', ' - ');
        }

        setInterval(updateClock, 1000);
        updateClock();
    </script>
</body>
</html>
